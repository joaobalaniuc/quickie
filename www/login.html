<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta http-equiv="Content-Security-Policy" content="default-src *; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui" />
        <meta charset="UTF-8"/>
        <title>Quickie - Login</title>
        <!-- JS -->
        <script src="cordova.js"></script>
        <script src="js/jquery-1.10.1.min.js" type="text/javascript"></script>
        <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
        <script src="login/login.js" type="text/javascript"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-form-validator/2.2.8/jquery.form-validator.min.js"></script>
        <!-- CSS -->
        <link href="login/styles.css" rel="stylesheet" />
        <link href="login/fonts.css" rel="stylesheet" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
        <script>
            $(document).ready(function () {
                loading("spinner", 1, false);
            });
        </script>
    </head>
    <body>

        <div id="loading-bkg"></div>
        <div id="loading-img">
            <div data-id="spinner">
                <img src="img/loadingdark.gif" style="width:112px;height:112px" />
            </div>
            <div data-id="globe">
                <img src="img/loading.gif" style="width:112px;height:112px" /><br/>
                Criando sua conta...<br/>
                <a href="#">Cancelar</a>
            </div>
        </div>


        <div id="content">

            <div data-show-id="login" class="data-show">

                <img src="img/quickie-logo.png" class="logo mb20" />

                <span style="display:none;">
                    <div class="cssload-wrap">
                        <div class="cssload-circle"></div>
                        <div class="cssload-circle"></div>
                        <div class="cssload-circle"></div>
                        <div class="cssload-circle"></div>
                        <div class="cssload-circle"></div>
                    </div>

                    <div style="text-align:center;line-height:20px;margin-top:32px" class="mb20">
                        <div class=" mb10">
                            <i class="fa fa-warning" style="font-size:32px"></i>
                        </div>
                        Você não está em um estabelecimento credenciado.
                    </div>
                </span>

                <span style="ddisplay:none;">
                    <div class="mb20">
                        <img src="img/woods.png" width="180" />
                    </div>

                    <div data-show="register" class="but light round mb10">
                        <i class="fa fa-facebook"></i> Entrar com Facebook
                    </div>

                    <div data-show="register" class="but light round mb30">
                        <i class="fa fa-twitter"></i> Entrar com Twitter
                    </div>
                </span>
                <!--
                                <div data-show="register" class="but light round mb10">
                                    <i class="fa fa-facebook"></i> Entrar com Facebook
                                </div>
                
                                <div data-show="register" class="but light round mb30">
                                    <i class="fa fa-twitter"></i> Entrar com Twitter
                                </div>
                -->

            </div> <!-- /login -->

            <div id="footer" class="center mb20">
                Quickie © - Copyright 2016 - By Nickford
            </div>

        </div><!-- #content -->

        <div class="bkg"></div>
    </body>

    <script>

        function fb_login() {
            FB.login(function (response) {
                if (response.authResponse) {
                    console.log('logando...');
                    console.log(response); // dump complete info
                    access_token = response.authResponse.accessToken; //get access token
                    user_id = response.authResponse.userID; //get FB UID

                    FB.api('/me', function (response) {
                        console.log('logado.');

                        $.each(response, function (key, value) {
                            console.log(key + ": " + value);
                        });

                        $.ajax({
                            url: "login.facebook.post.php",
                            type: "POST",
                            data: response,
                            success: function (res) {
                                //window.location = 'return.php?go=1';
                                console.log('redirect...');
                                console.log(res);
                            }
                        });
                    });

                } else {
                    //user hit cancel button
                    console.log('login aborted by user.');

                }
            }, {//,user_friends
                scope: 'user_birthday,user_posts,publish_actions,public_profile,email'
            });
        }

        // This is called with the results from from FB.getLoginStatus().
        function statusChangeCallback(response) {
            console.log('statusChangeCallback');
            console.log(response);
            if (response.status === 'connected') {
                // está "on" no face, e no app
                console.log('logged. redirect.');
                //window.location = 'return.php?go=1';
            } else if (response.status === 'not_authorized') {
                // está "on" no face, mas não cadastrado
            } else {
                // não está "on" no face
            }
        }

        window.fbAsyncInit = function () {
            FB.init({
                appId: '1604646033125808',
                oauth: true,
                status: true,
                cookie: true,
                xfbml: true,
                version: 'v2.2'
            });

            FB.getLoginStatus(function (response) {
                statusChangeCallback(response);
            });

        };

        // Load the SDK asynchronously
        (function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id))
                return;
            js = d.createElement(s);
            js.id = id;
            js.src = "//connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));




    </script>
</html>
